% -*-cap2.tex-*-
% Este fichero es parte de la plantilla LaTeX para
% la realización de Proyectos Final de Carrera, protegido
% bajo los términos de la licencia GFDL.
% Para más información, la licencia completa viene incluida en el
% fichero fdl-1.3.tex

% Copyright (C) 2009 Pablo Recio Quijano 

\section{Pruebas}

La fase de prueba es de las más importantes de un proyecto software~\cite{art}. El objetivo de este paso es, como razón
última, la verificación de que el proyecto cumple con todos los requisitos iniciales que se plantearon al comienzo 
del desarrollo. Según la metodología clásica de desarrollo de pruebas existen diferentes enfoques a la hora de realizar
este tipo de pruebas de software, siendo todos complementarios~\cite{beizer_software_1990}, pero para el caso
concreto que tenemos entre manos debemos tener en cuenta la naturaleza del proyecto. \\

Los videojuegos presentan dos facetas distintas que deben ser abordadas de diferentes maneras cuando se realiza la fase
de pruebas:
\begin{itemize}
    \item Por un lado tenemos las pruebas clásicas que se realizan a cualquier desarrollo de software, como pueden
            ser las pruebas unitarias o de integración, destinadas a verificar el correcto funcionamiento del
            código.
    \item Y por otro lado, al requerir de una interacción directa con el usuario (y estar destinado a divertir,
            entretener y proporcionar un rato ameno al mismo) se deben realizar varios tipos de pruebas orientadas
            a comprobar que se cumplen requisitos más abstractos como puede ser el testeo o análisis de la jugabilidad
            o usabilidad de la aplicación, interfaces, medir el entretenimiento que proporciona la aplicación (relacionado
            directamente con el desarrollo de la inteligencia artificial de los contrincantes, entre otros)
\end{itemize}

El primer conjunto de pruebas se pueden realizar con comprobaciones de código, compilación (o en este caso concreto,
interpretación) del mismo y diferentes métodos, pero el segundo conjunto de pruebas es necesario que se desarrollen
con diferentes tipos de usuarios reales manejando la aplicación y realizando cuestionarios que nos ayuden a valorar
el éxito o fracaso de estos apartados. \\

Para los apartados de pruebas unitarias y de integración se va a trabajar principalmente con los tres módulos que
forman el núcleo fuerte de la aplicación (y sobre las que cae el peso de la misma):

\begin{itemize}
    \item Sistema de gestión de partida de dominó
    \item Sistema de inteligencia artificial
    \item Motor gráfico de la aplicación
\end{itemize}

\subsection{Pruebas unitarias}

Durante la fase de implementación se fueron realizando pruebas unitarias no automatizadas de cada conjunto o subconjunto
de módulos que se iban desarrollando, evitando así encontrar errores en las pruebas de integración que no sean propiamente
de integración sino de errores en la codificación de los diferentes módulos.

En cuanto a los diferentes módulos que conforman Dominous, existen varios casos inherentes a cada módulo que deben
tratarse de forma individual (ya que dependen de la naturaleza del módulo) y de forma manual (ya que no se puede abordar su
solución de forma automática).

\subsubsection{Sistema de gestión de partida de dominó}

En este módulo las pruebas unitarias están claras: el módulo debe velar por el correcto cumplimiento de todas y cada
una de las reglas del dominó internacional. Para ello debe vigilarse cada movimiento de los jugadores, repasando
el estado del juego y las diferentes posibilidades que tiene el jugador, entrándose en modo error cuando se realiza
una acción ilegal. \\

En este momento del desarrollo se tuvo que tomar una decisión respecto a cómo contemplar los errores o incumplimiento de
normas que puedan producirse (de forma intencionada o no) por parte de los jugadores:

\begin{itemize}
    \item Una opción era permitir que los jugadores incumplan las normas y actuar en consecuencia contra el jugador.
            En ningún momento se puede permitir que los jugadores coloquen fichas en lugares donde está prohibido
            ese movimiento, por lo que, de todas las normas que posee el dominó las únicas candidatas a entrar en este
            grupo son las que hacen del dominó un \textbf{juego de señores}, es decir, todas aquellas que están destinadas
            a dotar de información a los demás jugadores de forma obligatoria (como puede ser la falta de un palo mediante
            acortar el tiempo que transcurre en su turno).

            Para esta opción teníamos nuevamente otras dos opciones:
            \begin{itemize}
                \item Podemos permitir y \emph{mirar hacia otro lado}, permitiendo que los jugadores engañen de forma
                        clara a los demás jugadores, incluyendo compañeros, o
                \item Podemos actuar como jueces y penalizar a los jugadores que cometan este tipo de faltas.
            \end{itemize}
    \item La otra opción es no permitir este tipo de acciones, volviendo hacia atrás en la acción del jugador y
            pidiendo de nuevo que actúe, hasta que la acción satisfaga las reglas del juego del dominó.
\end{itemize}

Finalmente se decidió que, dado que esta aplicación tiene como requisito el favorecer el aprendizaje del juego del dominó,
no existe cabida alguna a jugadas deshonrosas o que puedan llevar a equivocación al usuario que desea aprender a jugar. \\

Por lo tanto, cuando un jugador intenta realizar una acción equivocada, se deshace esa acción y se le pide de nuevo que
mueva ficha hasta que ese movimiento sea correcto, momento en el cual se continúa con naturalidad la partida.


\subsubsection{Sistema de Inteligencia Artificial}

El juego del dominó es un juego con un amplio universo de acciones y con conocimiento limitado de la situación de la partida,
por lo que no se puede estimar que una acción sea óptima (puede haber varias opciones válidas), pero a pesar de esto sí existe
un requisito que debe cumplirse (y se exige el cumplimiento) a la hora de realizar un movimiento, y es o pasar o colocar una
ficha cualquiera que pueda colocarse.

Esta acción se definió y se tomó como opción por defecto (también llamado fallback) en caso de que todas las demás reglas
de IA no se cumplan, y antes de que el sistema quede colgado o no se pueda continuar, se toma esta acción y se continúa
con la partida.


\subsection{Pruebas de integración}

Según se iban desarrollando módulos y éstos cumplían las pruebas unitarias desarrolladas para estos apartados, era necesario
integrar los diferentes módulos para corroborar y contrastar el correcto funcionamiento de la conjunción de ambos módulos.

\subsubsection{Sistema de Gestión de Partida de Dominó y Sistema de Inteligencia Artificial}

Una vez definida la interfaz de comunicación entre el Sistema de Gestión de Partida de Dominó y Sistema de Inteligencia
Artificial, para comprobar la consistencia de esta integración se desarrolló un jugador de dominó muy simple que debía
cumplir con dos premisas:

\begin{enumerate}
    \item El jugador debe cumplir con éxito las especificaciones de la interfaz.
    \item El jugador debe poner una ficha cualquiera (si puede colocar una ficha) o debe pasar (si no existe la posibilidad
            de mover).
\end{enumerate}

Durante el desarrollo del Sistema de Gestión de Partida de Dominó se fue comprobando el éxito de la comunicación entre ambos
módulos, de tal modo que cuando se realizó la integración con los dos sistemas totalmente finalizados no se encontraron
problemas graves, obteniéndose una integración suave y sin errores costosos de solventar.

\subsubsection{Sistema de Gestión de Partida de Dominó y Motor gráfico de la aplicación}

La integración fue más costosa que la comentada anteriormente, ya que no se pudo realizar un sistema de pruebas que
cumpliera las especificaciones de integración, pero gracias a que el Sistema de Gestión de Partida de Dominó contaba
con un gran número de métodos de todo tipo para obtener información del estado del tablero, jugadores y otros,
se pudo realizar la integración de forma sencilla y sin retrasarnos en demasía en la estimación de tiempos.


